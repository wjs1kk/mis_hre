importScripts("raonkupload.image.exif.js");
function processFile(a){var b=a.imageNewData;if(b){0>b.indexOf("data:image/jpeg;base64,")&&(b="data:image/jpeg;base64,"+b);try{var c=piexif.load(a.imageOriginalData);a.isIE||(c["0th"][274]&&1!=c["0th"][274]?c["0th"][274]=1:c["1st"][274]&&1!=c["1st"][274]&&(c["1st"][274]=1));c=piexif.dump(c);b=piexif.insert(c,b)}catch(e){}b=dataURItoBlob(b);a={workerIdx:a.workerIdx,fileIdx:a.fildIdx,newBlob:b};self.postMessage({type:"complete",sendData:a})}else a={workerIdx:a.workerIdx,fileIdx:a.fildIdx},self.postMessage({type:"error",
sendData:a})}self.onmessage=function(a){a=a.data;switch(a.type){case "start":processFile(a.sendData)}};function dataURItoBlob(a){var b=atob(a.split(",")[1]);a=a.split(",")[0].split(":")[1].split(";")[0];for(var c=new ArrayBuffer(b.length),e=new Uint8Array(c),d=0;d<b.length;d++)e[d]=b.charCodeAt(d);b=new DataView(c);return new Blob([b.buffer],{type:a})};
